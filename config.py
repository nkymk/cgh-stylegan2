"""
CGH-StyleGAN デフォルト設定

このファイルには学習・推論で使用するデフォルトのパラメータが
定義されています。コマンドライン引数で上書き可能です。
"""

# ==============================================================================
# 学習設定
# ==============================================================================
EPOCHS = 300
LEARNING_RATE = 1e-4
BATCH_SIZE = 6              # GPU1枚あたりのバッチサイズ

# ==============================================================================
# モデル設定
# ==============================================================================
LOG_RESOLUTION = 9          # 画像解像度のlog2 (9 = 512x512)
Z_DIM = 256                 # 潜在空間の次元
W_DIM = 256                 # 中間潜在空間の次元
MBSTD_GROUP_SIZE = -1       # Minibatch Stdのグループサイズ (-1 = バッチ全体)

# ==============================================================================
# ホログラム物理パラメータ
# ==============================================================================
PROPAGATION_DISTANCE = 0.5  # 伝播距離 [m]
WAVE_LENGTH = 486e-9        # 波長 [m] (青色光)
PITCH = 7.56e-6             # ピクセルピッチ [m]

# クロップ領域 (y_start, y_end, x_start, x_end)
# シミュレーション後の大きな画像から対象領域を切り出す
HOLOGRAM_CROP_REGION = (1100, 1612, 3100, 3612)

# ==============================================================================
# 損失関数の重み
# ==============================================================================
LAMBDA_GP = 10.0            # Gradient Penaltyの重み
LAMBDA_HOLO = 0.1           # CGHパターン（critic_holo）のロス重み
LAMBDA_REC = 1.0            # 再生像（critic_rec）のロス重み

# ==============================================================================
# データローダー設定
# ==============================================================================
NUM_WORKERS = 8             # DataLoaderのワーカー数
PREFETCH_FACTOR = 2         # プリフェッチするバッチ数

# ==============================================================================
# Mixed Precision設定
# ==============================================================================
# "fp16": 高速化重視（NVIDIA Tensor Core活用）
# "bf16": 数値安定性重視（Ampere以降のGPU）
# "no": 無効（従来のfp32）
MIXED_PRECISION = "bf16"

# ==============================================================================
# ログ・保存設定
# ==============================================================================
LOG_INTERVAL = 10           # ログ出力間隔（バッチ数）
SAVE_INTERVAL = 50          # サンプル保存間隔（エポック数）
NUM_SAMPLES = 100           # 保存するサンプル数

# ==============================================================================
# パス設定（デフォルト値、コマンドラインで上書き推奨）
# ==============================================================================
DEFAULT_OUTPUT_DIR = "./outputs"
